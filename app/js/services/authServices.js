define(["services/services"],function(e){e.service("authServices",["deploydService","$cookies","$httpParamSerializer",function(e,t,n){function i(n){var r=t.get("dCookie");if(r!=undefined){var i={Cookie:r};e.GetCurrentUser(i,function(t){t.id==undefined?s(function(t){if(t!=-1){var r=t.authResponse.userID;e.CheckExistingUser(r,function(e){n(e[0])})}else n(-1)}):n(t)})}else s(function(t){if(t!=-1){var r=t.authResponse.userID;e.CheckExistingUser(r,function(e){n(e[0])})}else n(-1)})}function s(e){FB.getLoginStatus(function(t){if(t.status==="connected"){var n=t.authResponse.userID,r=t.authResponse.accessToken;e(t)}else t.status==="not_authorized"?e(-1):e(-1)})}function o(n,r){f(angular.noop),e.UserLogin(n,function(e){e!=undefined&&(e.id!=undefined?(t.put("dCookie",e.id),i(function(e){r(e)})):r(-1))})}function u(n){var i=t.get("dCookie");if(i!=undefined){var s={Cookie:i};e.UserLogout(s,function(e){e.count==1?(r=undefined,n(0)):n(-1)})}}function a(t){u(angular.noop),FB.login(function(n){if(n.status==="connected"){var r=n.authResponse.accessToken;FB.api("/me","get",{access_token:r,fields:"id,name,gender"},function(n){e.CheckExistingUser(n.id,function(r){if(r.length==0){var i={};i.username=n.id,i.displayname=n.name,i.email=undefined,i.gender=n.gender,i.password="123456",i.status="active",i.role="FB",i.faculty=undefined,e.CreateUser(i,function(e){e.id!=undefined&&t(e)})}else e.CheckExistingUser(n.id,function(e){t(e[0])})})})}else t(-1)})}function f(e){(FB.getAccessToken()!=null||FB.getAccessToken()!=undefined)&&FB.logout(function(t){r=undefined,e(t)})}function l(e){data={client_id:"4fdec70e41b7cd7",client_secret:"bddbc8f146243973cef3154c1b174de88e7d5163",grant_type:"refresh_token",refresh_token:"b1569581ba7f023e59a77fd5bb344529eea4426a"},$.ajax({type:"POST",url:"https://api.imgur.com/oauth2/token",data:n(data),headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(t){e(t)},error:function(t){e(-1)}})}var r=undefined;return{GetCurrentUser:function(e){r==undefined?i(function(t){t==-1?(e(t),r=undefined):t.status=="active"?(e(t),r=t):(e(-1),r=undefined,alert("Your account unable to login, please contact admin."))}):e(r)},UserDeploydLogin:o,UserDeploydLogout:u,UserFacebookLogin:a,UserFacebookLogout:f,RequestAccessToken:l}}])});