define(["directives/directives"],function(e){e.directive("directLoginForm",["$compile","deploydService","$cookies","authServices","$rootScope",function(e,t,n,r,i){function s(e,n){function s(){n.find("#inputName").val(""),n.find("#inputPass").val(""),n.find("#recoverInputName").val(""),n.find("#recoverInputEmail").val(""),n.find(".invalidInput").hide(),n.find("#collapseRecover").collapse("hide")}n.find(".btnLogin").on("click",function(e){e.preventDefault(),e.stopPropagation(),n.find(".invalidInput").hide();var t=n.find("#inputName").val().trim(),s=n.find("#inputPass").val().trim(),o={username:t,password:s};r.UserDeploydLogin(o,function(e){e!=undefined&&e.displayname!=undefined?(n.modal("hide"),i.deploydLoginDisplayaname=e.displayname,i.deploydLoginUsername=e.username,i.$broadcast("deploydLoginDetails"),i.$broadcast("refreshPost")):n.find(".invalidInput").show()})}),n.on("keyup","#inputName , #inputPass",function(e){e.keyCode==13&&n.find(".btnLogin").click()}),n.find(".btnCancel").on("click",function(e){s()}),n.find(".btnRecover").on("click",function(e){e.preventDefault(),e.stopPropagation();var r=n.find("#recoverInputName").val().trim(),i=n.find("#recoverInputEmail").val().trim(),s={attr:"username",value:r};t.GetUserByAttr(s,function(e){var t=e[0];t!=undefined&&t.displayname!=undefined?t.email.toUpperCase==i.toUpperCase?console.log("this is correct email"):alert("incorrect email"):alert("username does not exist")})}),$("#my_login_Modal").on("hidden.bs.modal",function(){$(this).data("bs.modal",null),s()})}return{restrict:"E",template:'<div class="modal fade" id="my_login_Modal" role="dialog"><div class="modal-dialog"><!-- Modal content--><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">Login</h4></div><form role="form"><div class="form-group"><label for="usr">User Name : </label><input type="text" class="form-control" id="inputName"></div><div class="form-group"><label for="usr">Password : </label><input type="password" class="form-control" id="inputPass"></div></form><div class="modal-footer"><label for="invalid" class="invalidInput" style="color:red; display:none;float: left;">Invalid username or password.</label><small class="text-muted btnRecoverPw" value="Recover" data-toggle="collapse" href="#collapseRecover">Recover Password</small><button type="submit" class="btn btn-default btnLogin" data-dismiss="modal" value="Login">Login</button><button type="button" class="btn btn-default btnCancel" data-dismiss="modal">Close</button></div><div class="collapse" id="collapseRecover"><form role="form"><div class="form-group card-block card"><div class="form-group"><label for="usr">User Name : </label><input type="text" class="form-control" id="recoverInputName"></div><div class="form-group"><label for="usr">Email : </label><input type="text" class="form-control" id="recoverInputEmail"></div><div class="help-block with-errors"></div><button class="btn btn-primary btnRecover" type="submit">Recover</button></div></form></div></div></div></div>',controller:["$scope","$element",s],replace:!0}}])});